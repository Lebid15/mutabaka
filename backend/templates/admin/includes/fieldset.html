{# Self-contained fieldset include compatible with Django 5; preserves fieldset.classes #}
{% load i18n admin_urls static admin_modify %}

{# IMPORTANT: This template is included once per fieldset by the parent template.
	 It must render ONLY the provided 'fieldset' variable, not loop over adminform. #}

<fieldset class="module aligned {{ fieldset.classes }}">
	{% if fieldset.name %}<h2>{{ fieldset.name }}</h2>{% endif %}
	{% for line in fieldset %}
		<div class="form-row{% if line.errors %} errors{% endif %}{% if not line.has_visible_field %} hidden{% endif %}">
			{% for field in line %}
				<div class="fieldBox field-{{ field.field.name }}">
					{% if not field.is_readonly %}
						{{ field.label_tag }}
						{{ field.field }}
					{% else %}
						<label>{{ field.field.label|capfirst }}</label>
						<div class="readonly">{{ field.contents }}</div>
					{% endif %}
					{% if field.errors %}<div class="help text-red">{{ field.errors }}</div>{% endif %}
					{% if field.field.help_text %}<div class="help text-muted small">{{ field.field.help_text|safe }}</div>{% endif %}
				</div>
			{% endfor %}
		</div>
	{% endfor %}
</fieldset>
