# تطبيق مطابقة للهواتف (React Native)

هذا المجلد يحتوي على نسخة مبسطة من واجهة الويب لتطبيق مطابقة مبنية باستخدام **Expo** و **React Native** مع **NativeWind** لمواءمة التصميم والألوان مع الواجهة الأصلية.

## المتطلبات
- Node.js 18 أو أحدث
- Expo CLI (اختياري، يمكن التشغيل عبر `npx`)

## التثبيت
من داخل مجلد `mobile/`:

```powershell
npm install
```

## الأوامر الأساسية
- تشغيل التطبيق على Expo Go أو المحاكي:

  ```powershell
  npm run start
  ```

- تشغيل نسخة الويب (تجريبية):

  ```powershell
  npm run web
  ```

## البنية
- `App.tsx`: يضبط ThemeProvider والتنقل العام.
- `src/theme/`: يحتوي على design tokens وحالة السمة (فاتح/داكن).
- `src/components/`: مكونات UI قابلة لإعادة الاستخدام (أزرار، مدخلات، فقاعات الدردشة...إلخ).
- `src/screens/`: الشاشات الرئيسية (تسجيل الدخول، الرئيسية، الدردشة).
- `src/data/mock.ts`: بيانات تجريبية لعرض القوائم والمحادثات.

## إعداد الاتصال بالواجهة الخلفية
1. أنشئ ملف بيئة جديدًا انطلاقاً من القالب:

  ```powershell
  Copy-Item .env.example .env
  ```

2. يحاول التطبيق حالياً استنتاج عنوان الـ IP تلقائياً انطلاقاً من عنوان حزمة Expo (مثلاً `192.168.1.x`). إذا أحببت فرض عنوان محدد، حدّث المتغيرات التالية:
  - `EXPO_PUBLIC_API_BASE_URL` يجب أن يُشير إلى مسار الـ API الكامل (مثال: `http://192.168.1.20:8000/api`).
  - `EXPO_PUBLIC_WS_BASE_URL` لاستخدام قنوات الويب الحية لاحقاً.
  - `EXPO_PUBLIC_TENANT_HOST` يرسل مع كل طلب في ترويسة `X-Tenant-Host` كما يتطلب الباك إند.

3. بعد تحديث ملف البيئة شغّل Expo مجدداً لتطبيق الإعدادات.

### ما تم تنفيذه
- أي طلب HTTP يمر عبر ملف `src/lib/httpClient.ts` يضيف تلقائياً ترويسة `Authorization: Bearer` و`X-Tenant-Host`.
- يتم حفظ رموز JWT في `AsyncStorage` مع تخزين مؤقت بالذاكرة لتقليل الوصول للقرص.
- شاشة تسجيل الدخول تستدعي `POST /api/auth/token/` أو تسجيل دخول الفريق عبر `POST /api/auth/team/login` ثم تخزن الرموز وتعيد التوجيه للواجهة الرئيسية.
- شاشة المحادثات (`HomeScreen`) وجدت المستخدم الحالي، حمّلت قائمة المحادثات من `/api/conversations/`، وعرضت صورة الطرف الآخر إن وُجدت.
- شاشة الدردشة (`ChatScreen`) تعرض رسائل المحادثة من `/api/messages/` مع تحديث حالة التسليم/القراءة.

## مزامنة التصميم
- تم إعادة استخدام قيم الألوان والمسافات من الواجهة الأمامية (Tailwind) داخل NativeWind.
- زر التبديل بين الوضعين الفاتح والداكن يعكس نفس السلوك الموجود في الويب.
- شاشة الدردشة تستخدم نفس ألوان الفقاعات والبطاقات مع تباين ملائم.

## خطوات لاحقة مقترحة
- إضافة شاشة تفاصيل المحادثة (المشاركون، الكتم، الحذف).
- تنفيذ إرسال الرسائل والمعاملات المالية عبر API.
- دعم الإشعارات الفعلية (Push Notifications) للتطابق مع تجربة الويب.
